##  **План автоматизированного тестирования формы покупки тура.**
####  **Валидные значения полей:**
1. Номер карты: 16 числовых значений.
2. Месяц: число в двухзначном формате от 01 до 12. Если год карты совпадает с текущим, то номер месяца не должен быть меньше текущего.
3. Год: последние две цифры текущего года, в диапазоне +5 лет(включительно).
4. Владелец: двусоставное (last name, first name) из латинских символов с пробелом, дефисами, в верхнем регистре, в диапазоне от 3 до 20 символов(вкючительно).
5. CVC/CVV: Трехзначное число от 001 до 999.

Также в описании всех сценариев опускается первый переход по кнопке в зависимости от вида покупки:

Для всех сценариев "Покупка" шаг:
- С главной страницы по кнопке **"купить"** переходим к форме заполнения.

Для всех сценариев "Кредит"  шаг:
- С главной страницы по кнопке **"купить в кредит"** переходим к форме заполнения.

Последний шаг "отправка формы" по кнопке **"продолжить"** для всех сценариев одинаковый.
### Позитивные сценарии.
#### Покупка.
1. Вариант с валидной картой. Покупка должна быть одобрена банком.
- Входные данные кроме номера карты генерируются при помощи библиотеки Faker. Имя владельца. CVV код - 3 цифры. Год окончания действия карты - не более 5 лет с текущей даты. Месяц - номер месяца состоит из двух цифр. Номер карты: 1111 2222 3333 4444.
- Ожидаемый результат: Нет сообщений об ошибках в полях, получено всплывающее сообщение *"операция одобрена банком"*.
  В БД внесены данные об одобрении операции: в таблицу *order_entity* в поле *payment_id* записывается ID операции, в таблицу
  payment_entity в поле *status* заносится значение "APPROVED" в поле transaction_id - тот же ID, что и в таблицу *order_entity*.
#### Кредит
2. Вариант с валидной картой (покупка должна быть одобрена банком).
- Входные данные кроме номера карты генерируются при помощи библиотеки Faker.
  Имя владельца составное (first name, last name), локализация для имени владельца"EN"). CVV код - 3 цифры.
  Год окончания действия карты - не более 5 лет с текущей даты. Месяц - номер месяца состоит из двух цифр.
  Номер карты: 1111 2222 3333 4444.
- Ожидаемый результат: Нет сообщений об ошибках в полях, получено всплывающее сообщение *"операция одобрена банком"*,
  В БД внесены данные об одобрении операции: в таблицу *order_entity* в поле *credit_id* записывается ID операции, в таблицу
  *credit_request_entity* в поле *status* заносится значение "APPROVED" в поле *bank_id* -тот же ID, что и в таблицу *order_entity*.
#### Негативные сценарии
#### Кредит
3. Вариант с невалидной картой (покупка должна быть отклонена банком).
- Входные данные кроме номера карты генерируются при помощи библиотеки Faker.
  Имя владельца составное (first name, last name), локализация для имени владельца"EN"). CVV код - 3 цифры.
  Год окончания действия карты - не более 5 лет с текущей даты. Месяц - номер месяца состоит из двух цифр.
  Номер карты: 5555 6666 7777 8888.
- Ожидаемый результат: Нет сообщений об ошибках в полях, получено всплывающее сообщение *"Ошибка. Банк отказал в проведении операции"*,
  В БД внесены данные об одобрении операции: в таблицу *order_entity* в поле *credit_id* записывается ID операции, в таблицу
  *credit_request_entity* в поле *status* заносится значение "DECLINED" в поле *bank_id* -тот же ID, что и в таблицу *order_entity*.
#### Покупка
4. Вариант с невалидной картой (покупка должна быть отклонена банком).
- Входные данные кроме номера карты генерируются при помощи библиотеки Faker.
  Имя владельца составное (first name, last name), локализация для имени владельца"EN"). CVV код - 3 цифры.
  Год окончания действия карты - не более 5 лет с текущей даты. Месяц - номер месяца состоит из двух цифр.
  Номер карты: 5555 6666 7777 8888.
- Ожидаемый результат: Нет сообщений об ошибках в полях, получено всплывающее сообщение *"Ошибка. Банк отказал в проведении операции"*,
  В БД внесены данные об отказе в операции: в таблицу *order_entity* в поле *payment_id* записывается ID операции, в таблицу
  payment_entity в поле *status* заносится значение "DECLINED" в поле transaction_id -тот же ID, что и в таблицу *order_entity*.
5. Номер карты с полным номером - 16 цифр, но невалидная с точки зрения банка. Покупка должна быть отклонена банком.
- Входные данные генерируются при помощи библиотеки Faker, в том числе и номер карты.
  Имя владельца составное (first name, last name), локализация для имени владельца"EN"). CVV код - 3 цифры.
  Год окончания действия карты - не более 5 лет с текущей даты. Месяц - номер месяца состоит из двух цифр.
- Ожидаемый результат: Нет сообщений об ошибках в полях, получено всплывающее сообщение *"Ошибка. Банк отказал в проведении операции"*.
#### Тестирование полей на ввод невалидных значений
6. Невалидный формат номера карты - одна цифра "0". Валидный формат значения должен быть 16 цифр.
- В поле "номер карты" вводится "0".
- Входные данные кроме номера карты генерируются при помощи библиотеки Faker.
- Ожидаемый результат: Сообщение "неверный формат" под полем "номер карты".
7. Невалидный формат месяца - значение "00". Валидный формат значения должен быть от 01-12 (двузначный).
- В поле "месяц" вводится значение "00".
- Остальные входные данные кроме месяца генерируются при помощи библиотеки Faker.
- Ожидаемый результат: Сообщение "неверно указан срок действия карты" под полем "месяц".
8. Невалидный формат месяца - значение "13". Валидный формат значения должен быть от 01-12 (двузначный).
- В поле "месяц" вводится значение "13".
- Остальные входные данные кроме месяца генерируются при помощи библиотеки Faker.
- Ожидаемый результат: Сообщение "неверно указан срок действия карты" под полем "месяц".
9. Невалидный формат месяца - значение "1". Валидный формат значения должен быть от 01-12 (двузначный).
- В поле "месяц" вводится значение "1".
- Остальные входные данные кроме месяца генерируются при помощи библиотеки Faker.
- Ожидаемый результат: Сообщение "неверный формат" под полем "месяц".
10. Невалидный формат года - значение "1". Валидный формат значения должен быть не более 5 лет с текущей даты (двузначный).
- В поле "месяц" вводится значение "1".
- Остальные входные данные кроме месяца генерируются при помощи библиотеки Faker.
- Ожидаемый результат: Сообщение "неверный формат" под полем "месяц".
11. Невалидный формат года - значение "30".
- В поле "год" вводится значение "30". Валидный формат значения должен быть не более 5 лет с текущей даты (двузначный).
- Остальные входные данные кроме года генерируются при помощи библиотеки Faker.
- Ожидаемый результат: Сообщение "неверно указан срок действия карты" под полем "год".
12. Невалидный формат года - значение "00".
- В поле "год" вводится значение "00". Валидный формат значения должен быть не более 5 лет с текущей даты (двузначный).
- Остальные входные данные кроме года генерируются при помощи библиотеки Faker.
- Ожидаемый результат: Сообщение "неверно указан срок действия карты" под полем "год".
13. Поля месяц и год заполняются значениями с прошедшей датой. Год указывается текущий (важно!), а месяц - любой из предыдущего.
    Например, если текущая дата месяц-год 09/22, вводимое значение, например 07/22.
- Вводимые значения месяц и год генерируются при помощи библиотеки Faker с учетом условия выше.
- Остальные входные данные генерируются при помощи библиотеки Faker.
- Ожидаемый результат: Сообщение "неверно указан срок действия карты" под полем "месяц".
14. Невалидный формат значения в поле "Владелец" - цифры. Валидное значение - имя двусоставное владельца (last name, first name) на латинице.
- В поле "владелец" вводится любые три цифры (генерируется Faker)
- Остальные входные данные генерируются при помощи библиотеки Faker.
- Ожидаемый результат: Сообщение "неверный формат" под полем "владелец".
15. Невалидный формат значения в поле "Владелец" - имя на кириллице. Валидное значение - имя владельца двусоставное(last name, first name) на латинице.
- В поле "владелец" вводится любое имя на кириллице (генерируется Faker).
- Остальные входные данные генерируются при помощи библиотеки Faker. CVV код - 3 цифры.
- Ожидаемый результат: Сообщение "неверный формат" под полем "владелец".
16. Невалидный формат значения в поле "Владелец" - состоит из одного имени. Валидное значение - имя владельца двусоставное (last name, first name) на латинице.
- В поле "владелец" вводится любое first name (генерируется Faker).
- Остальные входные данные генерируются при помощи библиотеки Faker. CVV код - 3 цифры.
- Ожидаемый результат: Сообщение "неверный формат" под полем "владелец".
17. Невалидный формат значения в поле "Владелец" - содержит спецсимволы. Валидное значение - имя владельца двусоставное (last name, first name) на латинице.
- В поле "владелец" вводится значение состоящее из валидного имени (генерируется Faker)с добавлением спецсимвола вначале.
- Остальные входные данные генерируются при помощи библиотеки Faker.
- Ожидаемый результат: Сообщение "неверный формат" под полем "владелец".
18.  Невалидный формат значения в поле "Код" - содержит одну цифру. Валидное значение - три цифры.
- В поле "СVC/СVV" вводится значение состоящее из одной цифры.
- Остальные входные данные генерируются при помощи библиотеки Faker.
- Ожидаемый результат: Сообщение "неверный формат" под полем "СVC/СVV".
19. Сценарий проверки сообщений о некорректных значениях под полями. Сообщения должны пропадать после ввода валидных значений.
- Во все поля формы вводится *невалидное* значение состоящее из одной цифры.
- отправка формы
- Под каждым полем появляется сообщение "неверный формат"
- Во все поля формы вводится *валидные* значения.
  Данные генерируются при помощи библиотеки Faker.
- отправка формы
- Ожидаемый результат: Нет сообщений об ошибках в полях. Получено всплывающее сообщение *"Ошибка. Банк отказал в проведении операции"*.
20. Поле "Номер карты" пустое - не заполнено.
- Входные данные кроме номера карты генерируются при помощи библиотеки Faker. Поле "Номер карты" не заполняется.
- Ожидаемый результат: Под полем "Номер карты" появляется сообщение "Поле обязательно для заполнения".
21. Поле "Месяц" пустое - не заполнено.
- Входные данные кроме поля "Месяц" генерируются при помощи библиотеки Faker. Поле "Месяц" не заполняется.
- Ожидаемый результат: Под полем "Месяц" появляется сообщение "Поле обязательно для заполнения".
22. Поле "Год" пустое - не заполнено.
- Входные данные кроме поля "Год" генерируются при помощи библиотеки Faker. Поле "Год" не заполняется.
- Ожидаемый результат: Под полем "Год" появляется сообщение "Поле обязательно для заполнения".
23. Поле "Владелец" пустое - не заполнено.
- Входные данные кроме поля "Владелец" генерируются при помощи библиотеки Faker. Поле "Владелец" не заполняется.
- Ожидаемый результат: Под полем "Владелец" появляется сообщение "Поле обязательно для заполнения".
24. Поле "СVC/СVV" пустое - не заполнено.
- Входные данные кроме СVC/СVV кода генерируются при помощи библиотеки Faker. Поле "СVC/СVV" не заполняется.
- Ожидаемый результат: Под полем "СVC/СVV" появляется сообщение "Поле обязательно для заполнения".
#### Тестирование API.
#### Покупка
Входные данные кроме номера карты генерируются при помощи библиотеки Faker.
Имя владельца составное (first name, last name), локализация для имени владельца"EN"). CVV код - 3 цифры.
Год окончания действия карты - не более 5 лет с текущей даты. Месяц - номер месяца состоит из двух цифр.
Номер карты: 1111 2222 3333 4444.
25. Отправка POST запроса валидными данными. Покупка должна быть одобрена.
- Отправка POST запроса с валидными данными в формате JSON на адрес http://localhost:8080//api/v1/pay
- Ожидаемый результат: "StatusCode" ответа "200", "status" операции ""APPROVED".
#### Кредит
26. Отправка POST запроса валидными данными. Покупка должна быть одобрена.
- Отправка POST запроса с валидными данными в формате JSON на адрес http://localhost:8080//api/v1/credit
- Ожидаемый результат: "StatusCode" ответа "200", "status" операции ""APPROVED".
#### Негативный сценарий
Входные данные кроме номера карты генерируются при помощи библиотеки Faker.
Имя владельца составное (first name, last name), локализация для имени владельца"EN"). CVV код - 3 цифры.
Год окончания действия карты - не более 5 лет с текущей даты. Месяц - номер месяца состоит из двух цифр.
Номер карты: 5555 6666 7777 8888.
#### Покупка
27. Отправка POST запроса валидными данными. Покупка должна быть отклонена.
- Отправка POST запроса с валидными данными в формате JSON на адрес http://localhost:8080//api/v1/pay
- Ожидаемый результат: "StatusCode" ответа "200", "status" операции "DECLINED".
#### Кредит
28. Отправка POST запроса валидными данными. Операция должна быть отклонена.
- Отправка POST запроса с валидными данными в формате JSON на адрес http://localhost:8080//api/v1/credit
- Ожидаемый результат: "StatusCode" ответа "200", "status" операции DECLINED"

###  **Перечень используемых инструментов:**

* JDK 11. Код тестов на Java.
* IntelliJ IDEA. Среда подготовки авто-тестов.
* JUnit Jupiter. Фреймворк для тестирования.
* Gradle. Система сборки кода.
* Selenide. Продвинутый плагин для тестирования веб-интерфейса.
* Lombok. Плагин для минимизации строк кода за счет аннотаций.
* Faker. Плагин для генерации данных.
* Github. Как репозиторий для хранения кода.
* Gradle. Инструмент для создания простых отчетов и анализа результатов авто-тестов.
* Docker. Инструмент для создания контейнера тестируемой БД.

###  **Перечень и описание возможных рисков при автоматизации:**

* Излишняя загрузка рабочих мощностей сервера.
* Большое количество тестовых сценариев и сложность их поддержки после изменения UI сайта.
* Сложность в поиске локаторов элементов на страницах сайта т.к. далеко не все имеют явные привязки.
* После изменения структуры сайта, возможно, придётся уточнять локаторы элементов.
* Из-за требования поддержки разных СУБД, возможны проблемы с разностью диалекта языка SQL.
* Тесты должны быть гибкими и не должны зависить от даты и года их написания.
* При настройке CI могут возникуть проблемы с поднятием SUT и СУБД, в связи с требованием поддержки двух разных СУБД.

###   **План сдачи работ:**

1) Настройка тестового окружения: от 8 до 10 часов рабочего времени.
2) Создание и калибровка автотестов: от 16 до 24 часов рабочего времени.
3) Создание баг-репортов и отчёта по результатам прогона тестов: от 8 до 10 часов рабочего времени
4) Отчёт по результатам автоматизации: от 5 до 6 часов рабочего времени
5) Возможное подключение CI: от 8 до 10 часов рабочего времени.

Выполнение полного цикла работ по автоматизации данной задачи займет от 45 до 60 часов рабочего времени.